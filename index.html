<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>매장 관리 시스템</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<body>

  <header>
    <h1>매장 관리 시스템</h1>
  </header>

  <nav class="tabs-nav">
    <button class="tab-button active" data-tab="customers">고객 관리</button>
    <button class="tab-button" data-tab="products">재고 관리</button>
    <button class="tab-button" data-tab="sales">판매 및 주문</button>
  </nav>

  <main>
    <div id="customers-tab" class="tab-content active">
      <h2>고객 관리</h2>
      <div class="customer-controls">
        <div class="search-container">
          <input type="text" id="customer-search-input" placeholder="이름 또는 연락처 (뒷 4자리)로 고객 검색">
        </div>
        <button id="add-customer-btn">새 고객 추가</button>
      </div>
      <customer-list></customer-list>
      <customer-purchase-history></customer-purchase-history>
    </div>
          <div id="products-tab" class="tab-content">
          <h2>재고 관리</h2>
          <div class="product-controls">
            <button id="add-product-btn">새 제품 추가</button>
            <button id="discard-inventory-btn">재고 폐기</button>
            <button id="open-udi-scanner-btn">UDI로 제품 추가</button>
          </div>
          <product-list></product-list>
        </div>    <div id="sales-tab" class="tab-content">
      <h2>판매 및 주문</h2>
      <sale-transaction></sale-transaction>
      <sales-list></sales-list>
    </div>
  </main>

  <!-- 고객 폼 모달 -->
  <div id="customer-modal" class="modal">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <customer-form></customer-form>
    </div>
  </div>

  <!-- 제품 폼 모달 -->
  <div id="product-modal" class="modal">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <div id="product-modal-layout">
        <div id="product-form-container">
          <product-form></product-form>
        </div>
        <div id="temp-product-list-container">
          <h3>추가할 제품 목록</h3>
          <div id="temp-product-list"></div>
        </div>
      </div>
      <div class="modal-actions">
        <button id="save-all-products-btn">선택된 제품 모두 저장</button>
      </div>
    </div>
  </div>

  <!-- 브랜드별 제품 목록 모달 -->
  <div id="brand-product-list-modal" class="modal">
    <div class="modal-content large-modal">
      <span class="close-button" id="close-brand-product-list-modal">&times;</span>
      <brand-product-list-modal></brand-product-list-modal>
    </div>
  </div>

  <!-- 재고 폐기 모달 -->
  <div id="discard-inventory-modal" class="modal">
    <div class="modal-content large-modal">
      <span class="close-button" id="close-discard-inventory-modal">&times;</span>
      <discard-inventory-modal></discard-inventory-modal>
    </div>
  </div>

  <!-- UDI 스캐너 모달 -->
  <div id="udi-scanner-modal" class="modal">
    <div class="modal-content">
      <span class="close-button" id="close-udi-scanner-modal">&times;</span>
      <h3>UDI 바코드 스캔</h3>
      <div id="udi-input-section">
        <input type="text" id="udi-input" placeholder="UDI 바코드를 스캔하거나 입력하세요">
        <button id="lookup-udi-btn">제품 정보 조회</button>
      </div>
      <div id="udi-product-details">
        <h4>조회된 제품 정보:</h4>
        <div id="udi-product-info">
          <p><strong>브랜드:</strong> <span id="udi-brand"></span></p>
          <p><strong>모델명:</strong> <span id="udi-model"></span></p>
          <p><strong>UDI-DI:</strong> <span id="udi-gtin"></span></p>
          <p><strong>유통기한:</strong> <span id="udi-expiration-date"></span></p>
          <p><strong>로트 번호:</strong> <span id="udi-lot-number"></span></p>
          <p><strong>일련 번호:</strong> <span id="udi-serial-number"></span></p>
          <p><strong>렌즈 타입:</strong> <span id="udi-lens-type"></span></p>
          <p><strong>착용 주기:</strong> <span id="udi-wear-type"></span></p>
          <p><strong>수량:</strong> <input type="number" id="udi-quantity" value="1" min="1"></p>
          <p><strong>가격:</strong> <input type="number" id="udi-price" value="0.00" min="0"></p>
        </div>
        <p id="udi-status-message" style="color: red;"></p>
        <button id="add-udi-product-btn" disabled>재고에 추가</button>
      </div>
      <div id="scanner-viewport" style="width: 100%; height: 0px; overflow: hidden;"></div> <!-- Hide scanner-viewport for now -->
    </div>
  </div>

  <!-- Abnormal Inventory Side Panel -->
  <div id="abnormal-inventory-panel" class="side-panel">
    <div class="side-panel-header">
      <h2 class="vertical-text">이상 재고</h2>
    </div>
    <div class="side-panel-content">
      <abnormal-inventory-list></abnormal-inventory-list>
    </div>
  </div>

  <!-- Bookmark button for Abnormal Inventory -->
  <div id="abnormal-inventory-bookmark" class="bookmark-tab">
    <button id="toggle-abnormal-inventory-panel" class="bookmark-button">이상 재고</button>
  </div>

  <footer>
    <p>&copy; 2026 매장 관리 시스템</p>
  </footer>

  <script type="module" src="main.js"></script>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-functions-compat.js"></script>
  <!-- TODO: Add Firebase config here or in app-initializer.js -->
</body>
</html>